var f=this;Math.random();var h=function(a,d){var c=a.split("."),b=f;c[0]in b||!b.execScript||b.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===d?b=b[e]?b[e]:b[e]={}:b[e]=d};var l,p=function(a){a=a||[];for(var d=[],c=0,b=a.length;c<b;++c){var e=String(a[c]||"");e&&d.push(e)}if(!d.length)return null;l?l.reset.call(l):l=shindig.sha1();l.update.call(l,d.join(" "));return l.digestString.call(l).toLowerCase()},q=function(a,d,c){this.i=String(a||"");this.e=String(d||"");this.a=String(c||"");this.d={};this.g=this.k=this.f=this.h="";this.c=null};
q.prototype.evaluate=function(){var a={},d="";try{d=String(document.cookie||"")}catch(c){}for(var d=d.split("; ").join(";").split(";"),b=0,e=d.length;b<e;++b){var k=d[b],m=k.indexOf("=");-1!=m?a[k.substr(0,m)]=k.substr(m+1):a[k]=null}this.d=a;if(this.d.SID)if(this.e=this.e.split(".")[0].split("@")[0],a="",a=0==this.i.indexOf("https://")?"SAPISID":"APISID",this.f=String(this.d[a]||""))if(a="",a=0==gadgets.rpc.getOrigin(String(window.location.href)).indexOf("https://")?"SAPISID":"APISID",this.h=String(this.d[a]||
"")){d=String(this.d.LSOLH||"").split(":");b=d.length;if(1==b||4==b)this.k=d[0];if(3==b||4==b)a=String(d[b-3]||""),d=String(d[b-1]||""),(b=p([a,this.h]).substr(0,4))&&b==d&&(this.g=a);this.a&&(a=this.a.indexOf("."),-1!=a&&(a=this.a.substr(0,a)||"",this.a=a+"."+p([this.f,this.i,this.e,this.k,this.g,a]).substr(0,4)));a=p([this.f,this.i,this.e,this.a]);this.a&&(a=a+"."+this.a);this.c=a}else this.c="";else this.c=""};
var r=function(a,d,c){a=new q(a,d,c);a.evaluate();return a},t=function(a,d){var c=s(this),b=null;if(a){a=String(a);var e=a.indexOf(".");-1!=e&&(b=a.substr(e+1))}c=r(c,d,b);return a==c.c},u=function(a,d){var c=s(this),b=r(c);if(String(a)!=b.c)throw Error("Unauthorized request");var e=String(d),c=parseInt(e,10);String(c)==e&&0<=c?(b=b.g)?(b=b.split("|"),c=b.length<=c?null:b[c]||null):c=null:c=null;return c},s=function(a){a=String(a.origin||"");if(!a)throw Error("RPC has no origin.");return a};
h("checkSessionState",t);h("getVersionInfo",u);var v=function(a){window.setTimeout(function(){gadgets.rpc.getTargetOrigin("..")==gadgets.rpc.getOrigin(a)&&gadgets.rpc.call("..","oauth2callback:"+gadgets.rpc.getAuthToken(".."),void 0,a)},1)},w=function(){gadgets.rpc.call("..","oauth2relayReady:"+gadgets.rpc.getAuthToken(".."));gadgets.rpc.register("check_session_state",t);gadgets.rpc.register("get_versioninfo",u)};h("oauth2callback",v);
h("oauth2verify",function(a,d){var c=window.open("javascript:void(0);",a),b;if(c&&!c.closed&&(b=c.oauth2callbackUrl))return window.b=window.b||{},window.j=window.j||window.setTimeout,window.setTimeout=function(a,b){try{var d=a,n=!1,g;a=function(){if(!n){n=!0;try{window.b[String(g)]=void 0,delete window.b[String(g)]}catch(a){}return d.call(this)}};var x=c.setTimeout(a,b);g=window.j(a,b);window.b[String(g)]=x;return g}catch(y){}return window.j(a,b)},window.l=window.l||window.clearTimeout,window.clearTimeout=
function(a){try{var b=window.b[String(a)];b&&c.clearTimeout(b)}catch(d){}try{window.b[String(a)]=void 0,delete window.b[String(a)]}catch(n){}window.l(a)},v(String(b)),"keep_open"!=d&&window.setTimeout(function(){c.closed||c.close()},50),!0;c&&!c.closed&&c.close();return!1});window.addEventListener?window.addEventListener("load",w,!1):window.attachEvent("onload",w);
